var app=function(){"use strict";function e(){}function t(e){return e()}function n(){return Object.create(null)}function l(e){e.forEach(t)}function o(e){return"function"==typeof e}function a(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function r(t,n,l){t.$$.on_destroy.push(function(t,...n){if(null==t)return e;const l=t.subscribe(...n);return l.unsubscribe?()=>l.unsubscribe():l}(n,l))}function i(e){return null==e?"":e}function s(e,t,n=t){return e.set(n),t}function c(e,t){e.appendChild(t)}function u(e,t,n){e.insertBefore(t,n||null)}function d(e){e.parentNode.removeChild(e)}function m(e){return document.createElement(e)}function f(e){return document.createTextNode(e)}function p(){return f(" ")}function b(e,t,n,l){return e.addEventListener(t,n,l),()=>e.removeEventListener(t,n,l)}function g(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function y(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function w(e,t){for(let n=0;n<e.options.length;n+=1){const l=e.options[n];if(l.__value===t)return void(l.selected=!0)}}function h(e,t,n){e.classList[n?"add":"remove"](t)}let v;function $(e){v=e}function k(e){(function(){if(!v)throw new Error("Function called outside component initialization");return v})().$$.on_mount.push(e)}const O=[],j=[],T=[],_=[],x=Promise.resolve();let C=!1;function E(){C||(C=!0,x.then(P))}function A(e){T.push(e)}let S=!1;const F=new Set;function P(){if(!S){S=!0;do{for(let e=0;e<O.length;e+=1){const t=O[e];$(t),L(t.$$)}for($(null),O.length=0;j.length;)j.pop()();for(let e=0;e<T.length;e+=1){const t=T[e];F.has(t)||(F.add(t),t())}T.length=0}while(O.length);for(;_.length;)_.pop()();C=!1,S=!1,F.clear()}}function L(e){if(null!==e.fragment){e.update(),l(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(A)}}const N=new Set;let U;function I(){U={r:0,c:[],p:U}}function q(){U.r||l(U.c),U=U.p}function z(e,t){e&&e.i&&(N.delete(e),e.i(t))}function K(e,t,n,l){if(e&&e.o){if(N.has(e))return;N.add(e),U.c.push((()=>{N.delete(e),l&&(n&&e.d(1),l())})),e.o(t)}}function M(e){e&&e.c()}function G(e,n,a,r){const{fragment:i,on_mount:s,on_destroy:c,after_update:u}=e.$$;i&&i.m(n,a),r||A((()=>{const n=s.map(t).filter(o);c?c.push(...n):l(n),e.$$.on_mount=[]})),u.forEach(A)}function D(e,t){const n=e.$$;null!==n.fragment&&(l(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function R(t,o,a,r,i,s,c=[-1]){const u=v;$(t);const m=t.$$={fragment:null,ctx:null,props:s,update:e,not_equal:i,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(u?u.$$.context:o.context||[]),callbacks:n(),dirty:c,skip_bound:!1};let f=!1;if(m.ctx=a?a(t,o.props||{},((e,n,...l)=>{const o=l.length?l[0]:n;return m.ctx&&i(m.ctx[e],m.ctx[e]=o)&&(!m.skip_bound&&m.bound[e]&&m.bound[e](o),f&&function(e,t){-1===e.$$.dirty[0]&&(O.push(e),E(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}(t,e)),n})):[],m.update(),f=!0,l(m.before_update),m.fragment=!!r&&r(m.ctx),o.target){if(o.hydrate){const e=function(e){return Array.from(e.childNodes)}(o.target);m.fragment&&m.fragment.l(e),e.forEach(d)}else m.fragment&&m.fragment.c();o.intro&&z(t.$$.fragment),G(t,o.target,o.anchor,o.customElement),P()}$(u)}class W{$destroy(){D(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const J=[];function B(t,n=e){let l;const o=[];function r(e){if(a(t,e)&&(t=e,l)){const e=!J.length;for(let e=0;e<o.length;e+=1){const n=o[e];n[1](),J.push(n,t)}if(e){for(let e=0;e<J.length;e+=2)J[e][0](J[e+1]);J.length=0}}}return{set:r,update:function(e){r(e(t))},subscribe:function(a,i=e){const s=[a,i];return o.push(s),1===o.length&&(l=n(r)||e),a(t),()=>{const e=o.indexOf(s);-1!==e&&o.splice(e,1),0===o.length&&(l(),l=null)}}}}const Y=B({id:null,role:null,login:null,email:null,discord:null,username:null,children:[]}),H=B("/");function Q(e="/",t="id",n){const l=e.substring(1)||"table";window.history.pushState(l,l,e),n&&(window.location.search="?"+t+"="+n),H.set(e)}const V=B({});function X(){let e,t=!1;V.subscribe((t=>e=t));for(const n in e)if("manager"===e[n]){t=!0;break}return t}function Z(){let e,t=!1;V.subscribe((t=>e=t));for(const n in e)if("manager"===e[n]||"user"===e[n]){t=!0;break}return t}const ee=B({init:"test"});function te(t){let n,l,o,a,r=(t[1]||t[0])+"";return{c(){n=m("div"),l=f(r),g(n,"class","link-button svelte-1lu6yvv"),h(n,"current",t[2])},m(e,r){u(e,n,r),c(n,l),o||(a=b(n,"click",t[3]),o=!0)},p(e,[t]){3&t&&r!==(r=(e[1]||e[0])+"")&&y(l,r),4&t&&h(n,"current",e[2])},i:e,o:e,d(e){e&&d(n),o=!1,a()}}}function ne(e,t,n){let{to:l}=t,{label:o=l}=t,a=!1;return H.subscribe((e=>{e.substring(1)===l?n(2,a=!0):n(2,a=!1)})),e.$$set=e=>{"to"in e&&n(0,l=e.to),"label"in e&&n(1,o=e.label)},[l,o,a,function(){n(2,a=!a),Q("/"+l)}]}class le extends W{constructor(e){super(),R(this,e,ne,te,a,{to:0,label:1})}}if("localhost"===window.location.hostname)var oe=window.location.protocol+"//localhost:8000/api/";else oe=window.location.protocol+"//reputation.vpluseteam.com/api/";const ae={owner:"владелец",manager:"менеджер",user:"обычный пользователь",readonly:"только чтение"};function re(e){let t,n,l,o,a,r,i,s="root"===e[0].role||X();t=new le({props:{label:"Таблица",to:""}});let c=s&&se();return{c(){M(t.$$.fragment),n=p(),c&&c.c(),l=p(),o=m("div"),o.textContent="Выйти",g(o,"class","link-button svelte-dqos1q")},m(s,d){G(t,s,d),u(s,n,d),c&&c.m(s,d),u(s,l,d),u(s,o,d),a=!0,r||(i=b(o,"click",e[1]),r=!0)},p(e,t){1&t&&(s="root"===e[0].role||X()),s?c?1&t&&z(c,1):(c=se(),c.c(),z(c,1),c.m(l.parentNode,l)):c&&(I(),K(c,1,1,(()=>{c=null})),q())},i(e){a||(z(t.$$.fragment,e),z(c),a=!0)},o(e){K(t.$$.fragment,e),K(c),a=!1},d(e){D(t,e),e&&d(n),c&&c.d(e),e&&d(l),e&&d(o),r=!1,i()}}}function ie(t){let n,l;return n=new le({props:{to:"login",label:"Логин"}}),{c(){M(n.$$.fragment)},m(e,t){G(n,e,t),l=!0},p:e,i(e){l||(z(n.$$.fragment,e),l=!0)},o(e){K(n.$$.fragment,e),l=!1},d(e){D(n,e)}}}function se(e){let t,n,l,o;return t=new le({props:{to:"funds",label:"Фонды"}}),l=new le({props:{to:"users",label:"Пользователи"}}),{c(){M(t.$$.fragment),n=p(),M(l.$$.fragment)},m(e,a){G(t,e,a),u(e,n,a),G(l,e,a),o=!0},i(e){o||(z(t.$$.fragment,e),z(l.$$.fragment,e),o=!0)},o(e){K(t.$$.fragment,e),K(l.$$.fragment,e),o=!1},d(e){D(t,e),e&&d(n),D(l,e)}}}function ce(e){let t,n,l,o;const a=[ie,re],r=[];function i(e,t){return e[0].role?1:0}return n=i(e),l=r[n]=a[n](e),{c(){t=m("nav"),l.c(),g(t,"class","svelte-dqos1q")},m(e,l){u(e,t,l),r[n].m(t,null),o=!0},p(e,[o]){let s=n;n=i(e),n===s?r[n].p(e,o):(I(),K(r[s],1,1,(()=>{r[s]=null})),q(),l=r[n],l?l.p(e,o):(l=r[n]=a[n](e),l.c()),z(l,1),l.m(t,null))},i(e){o||(z(l),o=!0)},o(e){K(l),o=!1},d(e){e&&d(t),r[n].d()}}}function ue(e,t,n){let l,o;return r(e,Y,(e=>n(0,l=e))),r(e,V,(e=>n(2,o=e))),[l,async function(){"OK"===(await(async()=>{const e={method:"GET",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"}};try{return(await fetch(oe+"auth/logout",e)).json()}catch(e){return e}})()).status&&(s(Y,l={children:[]},l),s(V,o={},o),Q("/login"))}]}class de extends W{constructor(e){super(),R(this,e,ue,ce,a,{})}}const me=async(e,t,n)=>{const l={method:"PUT",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"},body:JSON.stringify({userId:e,role:t,fundId:n})};try{const e=await fetch(oe+"funds/addUser",l);return e.json()}catch(e){return e}},fe={title:"Создание фонда",fields:{name:{label:"Название",required:!0},email:{label:"E-mail",type:"email",rules:[e=>0==Boolean(e)||Boolean(e.includes("@")&&e.includes("."))||"неверный формат e-mail"]},skype:{label:"Skype"},site:{label:"Сайт"},discord:{label:"Сервер discord"},msg:{type:"html",value:"",service:!0}},methods:{async onSubmit(e,t,n){let l;Y.subscribe((e=>l=e.id)),console.log("%c⧭","color: #364cd9",l);const o={owner:l};for(const[e,t]of Object.entries(n))""!==t&&(o[e]=t);console.log("%c⧭","color: #807160",o);const a=await async function(e={}){const t={method:"POST",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"},body:JSON.stringify({...e})};try{return(await fetch(oe+"funds/create",t)).json()}catch(e){return e}}(o);e.fields.msg.value=a.msg,"OK"===a.status&&ee.update((e=>({...e,[a.data.fund.id]:n.name})))}},buttons:{submit:{label:"отправить",color:"primary"}}};function pe(t){let n;return{c(){n=m("main"),n.innerHTML='<div id="createGroupForm"></div>'},m(e,t){u(e,n,t)},p:e,i:e,o:e,d(e){e&&d(n)}}}function be(e){return k((()=>{window.callForm2("#createGroupForm",{},fe)})),[]}class ge extends W{constructor(e){super(),R(this,e,be,pe,a,{})}}function ye(t){let n;return{c(){n=m("main"),n.innerHTML='<div id="loginForm"></div>'},m(e,t){u(e,n,t)},p:e,i:e,o:e,d(e){e&&d(n)}}}function we(e){const t={fields:{credential:{label:"Логин, email или ник discord",type:"email"},password:{label:"Пароль",type:"password"},message:{type:"html",value:""}},methods:{async onSubmit(e,t,n,l){const o=await(async(e,t)=>{const n={method:"POST",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"},body:JSON.stringify({credential:e,password:t})};try{return(await fetch(oe+"auth/login/",n)).json()}catch(e){return e}})(n.credential,n.password);"OK"===o.status?(Y.set(o.data),e.fields.message.value=o.msg,setTimeout((()=>{Q("/")}),500)):e.fields.message.value=o.msg||"Неизвестная ошибка, проверьте подключение"}}};return k((()=>{window.callForm2("#loginForm",{},t)})),[]}class he extends W{constructor(e){super(),R(this,e,we,ye,a,{})}}function ve(t){let n,l,o,a,r=(t[1]||t[0])+"";return{c(){n=m("button"),l=f(r),g(n,"class","link-button ui button svelte-m74toc"),h(n,"current",t[2])},m(e,r){u(e,n,r),c(n,l),o||(a=b(n,"click",t[3]),o=!0)},p(e,[t]){3&t&&r!==(r=(e[1]||e[0])+"")&&y(l,r),4&t&&h(n,"current",e[2])},i:e,o:e,d(e){e&&d(n),o=!1,a()}}}function $e(e,t,n){let{to:l}=t,{label:o=l}=t,a=!1;return H.subscribe((e=>{e.substring(1)===l?n(2,a=!0):n(2,a=!1)})),e.$$set=e=>{"to"in e&&n(0,l=e.to),"label"in e&&n(1,o=e.label)},[l,o,a,function(){n(2,a=!a),Q("/"+l)}]}class ke extends W{constructor(e){super(),R(this,e,$e,ve,a,{to:0,label:1})}}function Oe(e,t,n){const l=e.slice();return l[15]=t[n],l}function je(e){let t,n,l;return{c(){t=f(e[0]),n=p(),l=m("br")},m(e,o){u(e,t,o),u(e,n,o),u(e,l,o)},p(e,n){1&n&&y(t,e[0])},d(e){e&&d(t),e&&d(n),e&&d(l)}}}function Te(e){let t,n,l,o,a=e[15].name+"";return{c(){t=m("option"),n=f(a),l=p(),t.__value=o=e[15].id,t.value=t.__value,g(t,"class","item svelte-1in54i1")},m(e,o){u(e,t,o),c(t,n),c(t,l)},p(e,l){4&l&&a!==(a=e[15].name+"")&&y(n,a),4&l&&o!==(o=e[15].id)&&(t.__value=o,t.value=t.__value)},d(e){e&&d(t)}}}function _e(e){let t,n,l;return n=new ke({props:{to:"createNote",label:"Создать запись"}}),{c(){t=m("div"),M(n.$$.fragment),g(t,"class","createContainer item svelte-1in54i1")},m(e,o){u(e,t,o),G(n,t,null),l=!0},i(e){l||(z(n.$$.fragment,e),l=!0)},o(e){K(n.$$.fragment,e),l=!1},d(e){e&&d(t),D(n)}}}function xe(e){let t,n,o,a,r,i,s,f,y,h,v,$,k,O,j,T,_,x,C="root"===e[3].role||Z(),E=e[0]&&je(e),S=e[2],F=[];for(let t=0;t<S.length;t+=1)F[t]=Te(Oe(e,S,t));let P=C&&_e();return{c(){t=m("main"),E&&E.c(),n=p(),o=m("div"),a=m("div"),r=m("select");for(let e=0;e<F.length;e+=1)F[e].c();i=p(),s=m("div"),f=m("input"),y=p(),h=m("i"),v=p(),P&&P.c(),$=p(),k=m("div"),O=p(),j=m("div"),g(r,"class","item svelte-1in54i1"),void 0===e[1]&&A((()=>e[6].call(r))),g(f,"type","text"),g(f,"placeholder","Поиск записей"),g(f,"class","svelte-1in54i1"),g(h,"class","search link icon"),g(s,"class","ui icon input item svelte-1in54i1"),g(a,"class","userControls inline ui input svelte-1in54i1"),g(o,"class","tableControls"),g(k,"id","tableMountingPoint"),g(j,"id","modalPoint")},m(l,d){u(l,t,d),E&&E.m(t,null),c(t,n),c(t,o),c(o,a),c(a,r);for(let e=0;e<F.length;e+=1)F[e].m(r,null);w(r,e[1]),c(a,i),c(a,s),c(s,f),c(s,y),c(s,h),c(a,v),P&&P.m(a,null),c(t,$),c(t,k),c(t,O),c(t,j),T=!0,_||(x=[b(r,"change",e[6]),b(r,"change",e[5]),b(f,"input",e[4])],_=!0)},p(e,[l]){if(e[0]?E?E.p(e,l):(E=je(e),E.c(),E.m(t,n)):E&&(E.d(1),E=null),4&l){let t;for(S=e[2],t=0;t<S.length;t+=1){const n=Oe(e,S,t);F[t]?F[t].p(n,l):(F[t]=Te(n),F[t].c(),F[t].m(r,null))}for(;t<F.length;t+=1)F[t].d(1);F.length=S.length}6&l&&w(r,e[1]),8&l&&(C="root"===e[3].role||Z()),C?P?8&l&&z(P,1):(P=_e(),P.c(),z(P,1),P.m(a,null)):P&&(I(),K(P,1,1,(()=>{P=null})),q())},i(e){T||(z(P),T=!0)},o(e){K(P),T=!1},d(e){e&&d(t),E&&E.d(),function(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}(F,e),P&&P.d(),_=!1,l(x)}}}let Ce="desc";function Ee(e,t,n){let l,o,a,i;r(e,Y,(e=>n(3,o=e))),r(e,V,(e=>n(9,a=e))),r(e,ee,(e=>n(10,i=e)));let s,c="",u="",d="";async function m(){const e=await(async(e,t="desc")=>{const n={method:"GET",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"}};try{return(e?await fetch(oe+"table?id="+e+"&order="+t,n):await fetch(oe+"table",n)).json()}catch(e){return e}})(undefined,Ce);return"OK"!==e.status?n(0,c=e.msg||e):e}function f(e=[],t){const n=e=>{const{field:t}=e._cell.column,n=e._cell.row.data[t].join(", "),l=document.createElement("div");return l.title=n,l.innerText=n,l},l=(e,t)=>({title:t,field:e,formatter:n});new Tabulator("#tableMountingPoint",{data:e,pagination:"remote",paginationSize:25,paginationSizeSelector:[10,25,50,100],ajaxURL:oe+"table",ajaxParams:{where:u,id:"",order:Ce,author:d},columnMaxWidth:300,dataTree:!0,columns:[{title:"<div class='editColumnTitle'></div>",field:"id",frozen:!0,minWidth:0,width:54,formatter(e){const t=e._cell.row.data.id,n=e._cell.row.data.author,l=document.createElement("i");return l.className="linkToRow material-icons notranslate",e._cell.row.data.history?(l.addEventListener("click",(()=>{p(t,e._cell.row.data)})),l.innerText="visibility",l):"root"===o.role||"admin"===o.role||a[n]&&"readonly"!==a[n]?(l.addEventListener("click",(()=>Q("/editNote","id",t))),l.innerText="create",l):(l.addEventListener("click",(()=>{p(t,e._cell.row.data)})),l.innerText="visibility",l)},headerSort:!1},{title:"Фонд",field:"author",formatter:e=>{const t=e._cell.row.data.author;return i[t]}},{title:"Создано",field:"created",formatter:e=>e._cell.row.data.old?"архив":moment(e._cell.row.data.created).format("MM-DD-YYYY")},{title:"Обновлено",field:"updated",formatter:e=>e._cell.row.data.old?"архив":moment(e._cell.row.data.updated).format("MM-DD-YYYY")},{title:"Автор",field:"fundName",visible:!1,sorter:"string"},{title:"Арбитраж",field:"case",width:150,formatter(e,t,n){const l=e._cell.row.data.case.map((e=>e.arbitrage)).join(", "),o=document.createElement("div");return o.title=l,o.innerText=l,o},sorter:"string"},{title:"Ники",field:"nickname",width:350,formatter(e){const t=e._cell.row.data.nickname.map((t=>e._cell.row.data.old?e._cell.row.data.nicknameOld:t.room?t.room+(t.value&&" - "+t.value):t.value)).join(", "),n=document.createElement("div");return n.title=t,n.innerText=t,n}},{title:"Дисциплина",field:"nickname",width:150,formatter:(e,t,n)=>e._cell.row.data.nickname.map((e=>e.discipline)).join(", "),sorter:"string"},{title:"ФИО",field:"FIO",width:250,formatter:(e,t,n)=>e._cell.row.data.FIO.map((e=>(e.lastname||"")+" "+(e.firstname||"")+" "+(e.middlename||""))).join(", ")},{title:"Описание",field:"case",width:250,formatter(e,t,n){const l=e._cell.row.data.case.map((e=>e.descr)).join(" | "),o=document.createElement("div");return o.title=l,o.innerText=l,o},sorter:"string"},{title:"Ущерб ($)",field:"case",width:100,formatter(e,t,n){const l=e._cell.row.data.case.map((e=>e.amount)).join(" | "),o=document.createElement("div");return o.title=l,o.innerText=l,o},sorter:"string"},l("gipsyteam","Gipsy team"),l("skype","Skype"),l("skrill","Skrill"),l("neteller","Neteller"),l("phone","Телефоны"),{title:"Адреса",field:"location",formatter:(e,t,n)=>e._cell.row.data.location.map((e=>e.country+" "+e.town+" "+e.address)).join(" ,")},l("pokerstrategy","Poker Strategy"),l("google","Google"),l("mail","e-mail"),l("vk","Вконтакте"),l("facebook","Facebook"),l("blog","Блог"),l("forum","Форум"),l("instagram","Instagram"),l("ecopayz","Ecopayz"),{title:"Webmoney",field:"webmoney",formatter:(e,t,n)=>e._cell.row.data.webmoney.map((e=>{const t=e.wallets&&Array.isArray(e.wallets)&&e.wallets.join(" ,");return e.WMID+": "+t})).join(" | ")},{title:"Комментарии",field:"comments"}],locale:!0,langs:{"en-gb":{columns:{},ajax:{loading:"Loading",error:"Error"},groups:{item:"item",items:"items"},pagination:{page_size:"Page Size",page_title:"Show Page",first:"First",first_title:"First Page",last:"Last",last_title:"Last Page",prev:"Prev",prev_title:"Prev Page",next:"Next",next_title:"Next Page",all:"All"},headerFilters:{default:"filter column...",columns:{column:"filter name..."}},custom:{}},"ru-ru":{columns:{},ajax:{loading:"Загрузка...",error:"Ошибка!"},groups:{item:"свойство",items:"свойства"},pagination:{page_size:"Кол-во строк",page_title:"Показать страницу",first:"Первая",first_title:"Первая страница",last:"Последняя",last_title:"Последняя страница",prev:"Пред.",prev_title:"Предыдущая страница",next:"След.",next_title:"Следущая страница",all:"Всё"},headerFilters:{default:"Отфильтровать...",columns:{}},custom:{}}},tableBuilt(){document.querySelector(".tabulator").classList.add("compact","very"),this.redraw(!0)}})}function p(e,t){const n={modal:!0,fields:{author:{label:"Автор",disabled:!0,value:i[e]},case:{label:"Арбитраж",type:"multiple",value:[],settings:{arbitrage:{label:"Арбитраж",row:1},descr:{label:"Описание",type:"textarea",row:1},amount:{label:"Размер",row:1}}},nickname:{label:"Дисциплины",type:"multiple",value:[],settings:{discipline:{label:"Дисциплина",row:1},room:{label:"Room",row:1},value:{label:"Nick",row:1}}},horizont:{type:"html",value:'<div class="filler"/>'},nicknameOld:{label:"Архивные значения",type:"textarea",visible:!1},FIO:{label:"ФИО",type:"multiple",value:[],settings:{firstname:{label:"Имя",row:1},lastname:{label:"Фамилия",row:1},middlename:{label:"Отчество",row:1}}},horizont2:{type:"html",value:'<hr class="q-ma-none q-pa-none"/>'},gipsyteam:{label:"Gipsy team",type:"creatable",outlined:!0},skype:{label:"Аккаунты Skype",type:"creatable",outlined:!0},skrill:{label:"Аккаунты skrill",type:"creatable",outlined:!0},neteller:{label:"Аккаунты neteller",type:"creatable",outlined:!0},phone:{label:"Телефоны",type:"creatable",outlined:!0},pokerstrategy:{label:"Poker Strategy",type:"creatable",outlined:!0},google:{label:"Google аккаунты",type:"creatable",outlined:!0},mail:{label:"Адреса e-mail",type:"creatable",outlined:!0},vk:{label:"Аккаунты vkontakte",type:"creatable",outlined:!0},facebook:{label:"Аккаунты facebook",type:"creatable",outlined:!0},blog:{label:"Блоги",type:"creatable",outlined:!0},instagram:{label:"Аккаунты instagram",type:"creatable",outlined:!0},forum:{label:"Форумы",type:"creatable",outlined:!0},ecopayz:{label:"Аккаунты ecopayz",type:"creatable",outlined:!0},location:{label:"Адреса",type:"multiple",value:[],settings:{country:{label:"Страна",row:1},town:{label:"Город",row:1},address:{label:"Адрес",row:1}}},webmoney:{label:"Аккаунты Webmoney",type:"multiple",value:[],settings:{WMID:{row:1,label:"WMID",required:!0},wallets:{label:"Кошельки",type:"creatable",row:1}}},comments:{label:"Комментарии",type:"textarea"},old:{type:"checkbox",label:"Архивная запись",hint:"снимите флажок, если запись была отредактирована в новый формат"}},title:"Просмотр записи",buttons:null,noButtons:!0,global:{fields:{readonly:!0}}};window.callForm2("#modalPoint",t,n)}return k((async()=>{const e=await m();e&&f(e.data,e.last_page);const t=[{id:"",name:"Все фонды"}];Object.entries(i).forEach((([e,n])=>t.push({id:e,name:n}))),n(2,l=t)})),n(2,l=[]),[c,d,l,o,async function(e){let t=e.target.value;clearTimeout(s),s=setTimeout((()=>{u=t,f()}),500)},function(e){f()},function(){d=function(e){const t=e.querySelector(":checked")||e.options[0];return t&&t.__value}(this),n(1,d),n(2,l)}]}class Ae extends W{constructor(e){super(),R(this,e,Ee,xe,a,{})}}const Se=async e=>{const t={method:"POST",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"},body:JSON.stringify({...e})};try{const e=await fetch(oe+"users/create/",t);return e.json()}catch(e){return e}},Fe=async e=>{const t={method:"GET",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"}};try{const n=await fetch(oe+"users/some?creds="+e,t);return n.json()}catch(e){return e}};async function Pe(e,t){let n;if("root"===e.role){const e=await(async()=>{const e={method:"GET",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"}};try{return(await fetch(oe+"users/all",e)).json()}catch(e){return e}})();return"OK"===e.status?(n=e.data,[n]):[n,e.msg||e]}const l=[];Object.entries(t).forEach((e=>{"owner"!==e[1]&&"manager"!==e[1]||l.push(e[0])})),l.length&&await Promise.all(l.map((async e=>{const t=await(async e=>{const t={method:"GET",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"}};try{return(await fetch(oe+"funds/getMembers?id="+e,t)).json()}catch(e){return e}})(e);if("OK"!==t.status)return[n,t.msg||t];n=t.data||[]})));if(e.children?.length){const e=await getChildren(app.state.token);if("OK"===e.status&&e.data.length&&(n=[...n,...e.data]),"OK"!==e.status)return[null,e.msg||e]}return[n.filter(((e,t,n)=>n.findIndex((t=>t.id===e.id))===t)).filter((e=>"root"!==e.role))]}function Le(e){let t,n,l;return n=new ke({props:{to:"createUser",label:"Создать пользователя"}}),{c(){t=m("div"),M(n.$$.fragment),g(t,"class","createContainer svelte-12b68td")},m(e,o){u(e,t,o),G(n,t,null),l=!0},i(e){l||(z(n.$$.fragment,e),l=!0)},o(e){K(n.$$.fragment,e),l=!1},d(e){e&&d(t),D(n)}}}function Ne(e){let t,n,l,o,a,r,i,s,f,y,w,h="root"===e[0].role&&Le();return{c(){t=m("div"),n=m("div"),l=m("input"),o=p(),a=m("i"),r=p(),h&&h.c(),i=p(),s=m("div"),g(l,"type","text"),g(l,"placeholder","Поиск пользователей"),g(l,"class","svelte-12b68td"),g(a,"class","search link icon"),g(n,"class","ui icon input item"),g(t,"class","userControls inline svelte-12b68td"),g(s,"id","tableMountingPoint")},m(d,m){u(d,t,m),c(t,n),c(n,l),c(n,o),c(n,a),c(t,r),h&&h.m(t,null),u(d,i,m),u(d,s,m),f=!0,y||(w=b(l,"input",e[1]),y=!0)},p(e,[n]){"root"===e[0].role?h?1&n&&z(h,1):(h=Le(),h.c(),z(h,1),h.m(t,null)):h&&(I(),K(h,1,1,(()=>{h=null})),q())},i(e){f||(z(h),f=!0)},o(e){K(h),f=!1},d(e){e&&d(t),h&&h.d(),e&&d(i),e&&d(s),y=!1,w()}}}function Ue(e,t,n){let l,o,a,i,s;r(e,ee,(e=>n(5,l=e))),r(e,Y,(e=>n(0,o=e)));let c=l;function u(){const e=a.map(((e,t)=>(e.index=t,e)));new window.Tabulator("#tableMountingPoint",{data:e,layout:"fitDataTable",pagination:"local",paginationSize:25,columns:[{title:"#",field:"index",sorter:"number",cellClick(e,t){Q("/editUser","id",t._cell.row.data.userProps.id)}},{title:" ",formatter(e){const t=e._cell.row.data.userProps.id,n=document.createElement("i");return n.className="linkToRow",n.addEventListener("click",(()=>Q("/editUser","id",t))),n.innerText="править",n}},{title:"Имя пользователя",field:"username",sorter:"string"},{title:"Логин",field:"login",sorter:"string"},{title:"Ник discord",field:"discord",sorter:"string"},{title:"E-mail",field:"email",sorter:"string"},{title:"Фонды",field:"groups",formatter(e){const t=e._cell.row.data.userProps.funds;if(!t)return"";const n=[];return Object.entries(t).forEach((([e,t])=>{n.push(c[e]+" - "+ae[t])})),n.length?n.join(", "):""}}]})}return k((async()=>{[a,s]=await Pe(o),i=[...a],a&&u()})),[o,function(e){let t=e.target.value;if(a){if(t.length)return t=t.toLocaleLowerCase(),a=i.filter((e=>{let{username:n,email:l,discord:o,login:a,funds:r}=e;return!(!n||!n.toLocaleLowerCase().includes(t))||(!(!l||!l.toLocaleLowerCase().includes(t))||(!(!o||!o.toLocaleLowerCase().includes(t))||(!(!a||!a.toLocaleLowerCase().includes(t))||void 0)))})),u();a=i,u()}}]}class Ie extends W{constructor(e){super(),R(this,e,Ue,Ne,a,{})}}function qe(t){let n;return{c(){n=m("div"),n.innerHTML='<div id="createUserForm"></div>'},m(e,t){u(e,n,t)},p:e,i:e,o:e,d(e){e&&d(n)}}}function ze(e,t,n){let l;r(e,Y,(e=>n(0,l=e)));const o=[{id:"guest",name:"Обычный"}];"root"===l.role&&o.unshift({id:"root",name:"root"});const a={fields:{name:{label:"Имя пользователя",hint:"Как к вам обращаться"},login:{label:"Логин"},discord:{label:"Ник discord"},email:{label:"E-mail",type:"email",rules:[e=>0==e||Boolean(e.includes("@")&&e.includes("."))||"неверный формат e-mail"]},password:{label:"Пароль",type:"password",required:!0,rules:[e=>e.length>5||"введите минимум 6 символов"]},role:{label:"Роль",type:"select",autocomplete:!1,options:o,value:"guest",visible:o.length>1},message:{type:"html",value:"",service:!0}},methods:{async onSubmit(e,t,n){if(!n.login&&!n.discord&&!n.email)return e.fields.message.value="Введите логин, или discord или email";const o={};for(const[e,t]of Object.entries(n))""!==t&&(o[e]=t);const a=await Se(o);var r;console.log("%c⧭","color: #40fff2",a),e.fields.message.value=a.msg||"Неизвестная ошибка, проверьте подключение","OK"===a.status&&(r=a.user.id,l.children.push(r))}},title:"Создать пользователя"};return k((()=>{window.callForm2("#createUserForm",{},a)})),[]}class Ke extends W{constructor(e){super(),R(this,e,ze,qe,a,{})}}function Me(t){let n,l,o;return{c(){n=m("div"),l=p(),o=f(t[0]),g(n,"id","formEditUser")},m(e,t){u(e,n,t),u(e,l,t),u(e,o,t)},p(e,[t]){1&t&&y(o,e[0])},i:e,o:e,d(e){e&&d(n),e&&d(l),e&&d(o)}}}function Ge(e,t,n){let l;r(e,Y,(e=>n(2,l=e)));const o=new URLSearchParams(window.location.search).get("id");let a,i="",s=l;async function c(){const e=await(async e=>{const t={method:"GET",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"}};try{return(await fetch(oe+"users/fullInfo?id="+e,t)).json()}catch(e){return e}})(o);"OK"===e.status?(a=e.data,function(){const e=[{id:"guest",name:"Обычный"}];"root"===s.role&&e.unshift({id:"root",name:"root"});const t={fields:{username:{label:"Имя пользователя"},login:{label:"Логин"},discord:{label:"Ник discord"},email:{label:"E-mail",type:"email"},role:{label:"Роль",key:"",type:"select",autocomplete:!1,options:e,value:"guest",visible:"root"===s.role},password:{label:"Задать новый пароль",type:"password",rules:[e=>0==Boolean(e)||e.length>5||"введите минимум 6 символов"]},msg:{type:"html",value:"",service:!0}},methods:{async onSubmit(e,t,n){if(!n.login&&!n.discord&&!n.email)return void(e.fields.msg.value="Введите логин, или discord или email");e.fields.msg.value="";const l={};for(const[e,t]of Object.entries(n))""!==t&&(l[e]=t);const a=await(async(e,t)=>{const n={method:"PUT",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"},body:JSON.stringify({...t,id:e})};try{return(await fetch(oe+"users/updateAnoterUser",n)).json()}catch(e){return e}})(o,l);e.fields.msg.value=a.msg}}};window.callForm2("#formEditUser",{...a},t)}()):n(0,i=e.msg||e)}return k((async()=>{c()})),[i]}class De extends W{constructor(e){super(),R(this,e,Ge,Me,a,{})}}function Re(e){let t,n,l;return n=new ke({props:{to:"createUser",label:"Создать фонд"}}),{c(){t=m("div"),M(n.$$.fragment),g(t,"class","createContainer svelte-1ocrjsp")},m(e,o){u(e,t,o),G(n,t,null),l=!0},i(e){l||(z(n.$$.fragment,e),l=!0)},o(e){K(n.$$.fragment,e),l=!1},d(e){e&&d(t),D(n)}}}function We(e){let t,n,l,o,a,r,i,s,w,h,v,$,k,O="root"===e[1].role&&Re();return{c(){t=m("div"),n=m("div"),l=m("input"),o=p(),a=m("i"),r=p(),O&&O.c(),i=p(),s=m("div"),w=p(),h=f(e[0]),g(l,"type","text"),g(l,"placeholder","Поиск фондов"),g(l,"class","svelte-1ocrjsp"),g(a,"class","search link icon"),g(n,"class","ui icon input item"),g(t,"class","fundControls inline svelte-1ocrjsp"),g(s,"id","tableMountingPoint")},m(d,m){u(d,t,m),c(t,n),c(n,l),c(n,o),c(n,a),c(t,r),O&&O.m(t,null),u(d,i,m),u(d,s,m),u(d,w,m),u(d,h,m),v=!0,$||(k=b(l,"input",e[2]),$=!0)},p(e,[n]){"root"===e[1].role?O?2&n&&z(O,1):(O=Re(),O.c(),z(O,1),O.m(t,null)):O&&(I(),K(O,1,1,(()=>{O=null})),q()),(!v||1&n)&&y(h,e[0])},i(e){v||(z(O),v=!0)},o(e){K(O),v=!1},d(e){e&&d(t),O&&O.d(),e&&d(i),e&&d(s),e&&d(w),e&&d(h),$=!1,k()}}}function Je(e,t,n){let l,o,a;r(e,ee,(e=>n(5,e))),r(e,Y,(e=>n(1,l=e)));let i="";function s(){const e=o.map(((e,t)=>(e.index=t,e)));new window.Tabulator("#tableMountingPoint",{layout:"fitDataTable",data:e,pagination:"local",paginationSize:25,columns:[{title:"#",field:"index",sorter:"number"},{title:"",field:"id",formatter(e){const t=e._cell.row.data.id,n=document.createElement("i");return n.className="linkToRow",n.addEventListener("click",(()=>Q("/editFund","id",t))),n.innerText="править",n}},{title:"Название",field:"name",sorter:"string"},{title:"Discord",field:"discord",sorter:"string"},{title:"Сайт",field:"site",sorter:"string"}]})}return k((async()=>{const e=await(async()=>{const e={method:"GET",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"}};try{return(await fetch(oe+"funds/getFunds",e)).json()}catch(e){return e}})();"OK"===e.status?(o=e.data,a=[...e.data],s()):n(0,i=e.msg||e)})),[i,l,function(e){let t=e.target.value;if(o){if(t.length)return t=t.toLocaleLowerCase(),o=a.filter((e=>{let{name:n,site:l,discord:o}=e;return!(!n||!n.toLocaleLowerCase().includes(t))||(!(!l||!l.toLocaleLowerCase().includes(t))||(!(!o||!o.toLocaleLowerCase().includes(t))||void 0))})),s();o=a,s()}}]}class Be extends W{constructor(e){super(),R(this,e,Je,We,a,{})}}function Ye(e){let t,n,l,o=e[2]?.name+"";return{c(){t=m("h5"),n=f("Фонд "),l=f(o),g(t,"class"," svelte-neoc7b")},m(e,o){u(e,t,o),c(t,n),c(t,l)},p(e,t){4&t&&o!==(o=e[2]?.name+"")&&y(l,o)},d(e){e&&d(t)}}}function He(e){let t,n,l;return{c(){t=f(e[1]),n=p(),l=m("br")},m(e,o){u(e,t,o),u(e,n,o),u(e,l,o)},p(e,n){2&n&&y(t,e[1])},d(e){e&&d(t),e&&d(n),e&&d(l)}}}function Qe(e){let t,n,l;return{c(){t=m("div"),n=p(),l=m("div"),g(t,"id","usersTable"),g(l,"id","userEditor")},m(e,o){u(e,t,o),u(e,n,o),u(e,l,o)},d(e){e&&d(t),e&&d(n),e&&d(l)}}}function Ve(e){let t,n,l;return{c(){t=m("div"),n=p(),l=m("div"),g(t,"id","addUsersForm"),g(l,"id","regAndAddUsersForm")},m(e,o){u(e,t,o),u(e,n,o),u(e,l,o)},d(e){e&&d(t),e&&d(n),e&&d(l)}}}function Xe(e){let t;return{c(){t=m("div"),g(t,"id","editGroupForm")},m(e,n){u(e,t,n)},d(e){e&&d(t)}}}function Ze(t){let n,o,a,r,s,y,w,h,v,$,k,O,j,T,_,x,C,E,A=t[2]&&Ye(t),S=t[1]&&He(t);function F(e,t){return 0===e[0]?Xe:1===e[0]?Ve:2===e[0]?Qe:void 0}let P=F(t),L=P&&P(t);return{c(){n=m("main"),A&&A.c(),o=p(),a=m("div"),r=m("div"),s=f("Общая информация"),w=p(),h=m("div"),v=f("Добавить участников"),k=p(),O=m("div"),j=f("Редактировать участников"),_=p(),S&&S.c(),x=p(),L&&L.c(),g(r,"class",y=i(0===t[0]?"current":"link-button")+" svelte-neoc7b"),g(h,"class",$=i(1===t[0]?"current":"link-button")+" svelte-neoc7b"),g(O,"class",T=i(2===t[0]?"current":"link-button")+" svelte-neoc7b"),g(a,"class","navigation svelte-neoc7b")},m(e,l){u(e,n,l),A&&A.m(n,null),c(n,o),c(n,a),c(a,r),c(r,s),c(a,w),c(a,h),c(h,v),c(a,k),c(a,O),c(O,j),c(n,_),S&&S.m(n,null),c(n,x),L&&L.m(n,null),C||(E=[b(r,"click",t[4]),b(h,"click",t[5]),b(O,"click",t[6])],C=!0)},p(e,[t]){e[2]?A?A.p(e,t):(A=Ye(e),A.c(),A.m(n,o)):A&&(A.d(1),A=null),1&t&&y!==(y=i(0===e[0]?"current":"link-button")+" svelte-neoc7b")&&g(r,"class",y),1&t&&$!==($=i(1===e[0]?"current":"link-button")+" svelte-neoc7b")&&g(h,"class",$),1&t&&T!==(T=i(2===e[0]?"current":"link-button")+" svelte-neoc7b")&&g(O,"class",T),e[1]?S?S.p(e,t):(S=He(e),S.c(),S.m(n,x)):S&&(S.d(1),S=null),P!==(P=F(e))&&(L&&L.d(1),L=P&&P(e),L&&(L.c(),L.m(n,null)))},i:e,o:e,d(e){e&&d(n),A&&A.d(),S&&S.d(),L&&L.d(),C=!1,l(E)}}}function et(e,t,n){let l;r(e,Y,(e=>n(11,l=e)));const o=new URLSearchParams(window.location.search).get("id");let a,i=0,s="",c=[{label:"Менеджер",value:"manager"},{label:"Обычный пользователь",value:"user"},{label:"Только чтение",value:"readonly"}];const u={};let d,m,f;function p(){const e={fields:{name:{label:"Название",required:!0},email:{label:"E-mail",type:"email"},skype:{label:"Skype"},site:{label:"Сайт"},discord:{label:"Сервер discord"},owner:{label:"Создатель",hint:"Начните вводить имя или e-mail",options:[{name:a.owner.label||"",id:a.owner.value||""}],type:"select",async onKeyDown(e,t,n){if(n&&n.length>2){const l=await Fe(n);"OK"===l.status&&(l.data.forEach((e=>e.name=e.username)),e.fields.owner.options=l.data,l.data.length&&t.$refs.input.blur())}},onInput(e,t,n){const l=e.fields.owner.options.find((e=>e.id===n));d=l}},msg:{type:"html",value:""}},methods:{async onSubmit(e,t,l){if(l.owner&&l.owner!==a.owner.value){const t=await(async(e,t,n)=>{const l={method:"PUT",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"},body:JSON.stringify({fundId:e,ownerId:t,prevOwnerId:n})};try{return(await fetch(oe+"funds/updateOwner",l)).json()}catch(e){return e}})(a.id,l.owner,a.owner.value);"OK"===t.status&&(n(2,a.owner=d,a),d=null,u[l.owner]="owner",u[a.owner.value]&&delete u[a.owner.value]),e.fields.msg.value=t.msg||t}const o={};for(const[e,t]of Object.entries(l))""!==t&&"owner"!==e&&(o[e]=t);const r=await(async(e,t)=>{const n={method:"PUT",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"},body:JSON.stringify({fundId:e,data:t})};try{return(await fetch(oe+"funds/updateForm",n)).json()}catch(e){return e}})(a.id,o);"OK"===r.status&&(delete l.owner,n(2,a={...a,...l})),e.fields.msg.value=r.msg}}};window.callForm2("#editGroupForm",{...a,owner:a.owner.value},e)}function b(){const e=[...a.managers,...a.users,...a.readonlys].filter((e=>e.id!==l.id));new Tabulator("#usersTable",{layout:"fitDataTable",data:e,pagination:"local",paginationSize:15,columns:[{title:"Имя пользователя",field:"username",sorter:"string"},{title:"Логин",field:"login",sorter:"string"},{title:"Ник discord",field:"discord",sorter:"string"},{title:"E-mail",field:"email",sorter:"string"},{title:"Роль",field:"role",sorter:"string",formatter(e){const t=u[e._cell.row.data.id];return ae[t]}},{title:"",field:"id",formatter(e){const t=u[e._cell.row.data.id],l=document.createElement("button");return l.className="linkToRow",l.addEventListener("click",(()=>{m={...e._cell.row.data,role:t},f=t,n(1,s=""),function(){const e={fields:{role:{row:1,type:"select",label:"Выберете новую роль",options:c.filter((e=>e.value!==f)),required:!0},deleteUser:{type:"button",label:"или",value:"Удалите пользователя",color:"red",size:"sm",async onClick(e){const t=await(async(e,t,n)=>{const l={method:"DELETE",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"},body:JSON.stringify({userId:e,fundId:t,prevRole:n})};try{return(await fetch(oe+"funds/deleteUser",l)).json()}catch(e){return e}})(m.id,a.id,f);e.fields.msg.value=t.msg||t,"OK"===t.status&&(delete u[m.id],await g(),b(),e.modal.closeModal())}},msg:{type:"html",value:""}},methods:{async onSubmit(e,t,n){const l=await(async(e,t,n,l)=>{const o={method:"PUT",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"},body:JSON.stringify({userId:e,role:t,fundId:l,prevRole:n})};try{return(await fetch(oe+"funds/updateUser",o)).json()}catch(e){return e}})(m.id,n.role,f,a.id);e.fields.msg.value=l.msg||l,"OK"===l.status&&(await g(),b())}},modal:!0,buttons:{submit:{label:"Обновить роль",color:"primary"}},title:"Редактирование пользователя "+m.username};window.callForm2("#userEditor",{},e)}()})),l.innerText="выбрать",l}}]})}async function g(){const e=await(async e=>{const t={method:"GET",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"}};try{return(await fetch(oe+"funds/formatted?id="+e,t)).json()}catch(e){return e}})(o);if("OK"===e.status)return n(2,a=e.data),a.owner?.value&&(u[a.owner.value]="owner"),a.managers.forEach((e=>u[e.value]="manager")),a.users.forEach((e=>u[e.value]="user")),a.readonlys.forEach((e=>u[e.value]="readonly")),a;n(1,s=e.msg||e)}async function y(e=0){return n(0,i=e),n(1,s=""),await(E(),x),0===e?p():1===e?function(){const e={title:"Добавить зарегистрированных участников",fields:{user:{label:"Логин, discord или e-mail",hint:"Начните вводить логин, discord или e-mail (мин. 3 символа)",options:[{name:"",id:""}],type:"select",async onKeyDown(e,t,n){if(n&&n.length>2){const l=await Fe(n);"OK"===l.status&&(l.data.forEach((e=>e.name=e.username)),e.fields.user.options=l.data,l.data.length&&t.$refs.input.blur())}},onInput(e,t,n){const l=e.fields.user.options.find((e=>e.id===n));d=l}},role:{label:"Роль",options:c,type:"select",required:!0},msg:{type:"html",value:"",service:!0}},methods:{async onSubmit(e,t,n){if(u[n.user])return void(e.fields.msg.value="Пользователь уже добавлен, перейдите во вкладку редактирования");const l=await me(n.user,n.role,a.id);"OK"===l.status&&(a[n.role+"s"].push({label:d.name,value:d.id}),u[n.user]=n.role,await g()),e.fields.msg.value=l.msg||l}},buttons:{submit:{label:"Добавить",color:"primary"}}};window.callForm2("#addUsersForm",{},e)}()||function(){const e=[{id:"guest",name:"Обычный"}];"root"===l.role&&e.unshift({id:"root",name:"root"});const t={title:"Зарегистрировать и добавить участников",fields:{login:{label:"Логин"},name:{label:"Имя пользователя"},discord:{label:"Ник discord"},email:{label:"E-mail",type:"email",rules:[e=>0==e||Boolean(e.includes("@")&&e.includes("."))||"неверный формат e-mail"]},password:{label:"Пароль",type:"password",rules:[e=>e.length>5||"введите минимум 6 символов"],required:!0},role:{label:"Роль на сайте",type:"select",autocomplete:!1,options:e,value:"guest",visible:"root"===l.role,required:!0},groupRole:{label:"Роль в фонде",type:"select",options:[{name:"Менеджер",id:"manager"},{name:"Обычный",id:"user"},{name:"Только чтение",id:"readonly"}],required:!0},msg:{type:"html",value:"",service:!0}},methods:{async onSubmit(e,t,n){if(!n.login&&!n.discord&&!n.email)return void(e.fields.msg.value="Введите логин, или discord или email");const o={};for(const[e,t]of Object.entries(n))""!==t&&"groupRole"!==e&&(o[e]=t);const r=await Se(o);if("OK"!==r.status)return!1;e.fields.msg.value=r.msg||r;const i=r.data;l.children.push(i.id);const s=await me(i.id,n.groupRole,a.id);"OK"===s.status&&(a[n.groupRole+"s"].push({label:i.name,value:i.id}),u[i.id]=n.groupRole,await g()),e.fields.msg.value=s.msg||s}},buttons:{submit:{label:"Создать и добавить",color:"primary"}}};window.callForm2("#regAndAddUsersForm",{},t)}():2===e?b():void 0}k((async()=>{await g()&&p()}));return[i,s,a,y,()=>y(0),()=>y(1),()=>y(2)]}class tt extends W{constructor(e){super(),R(this,e,et,Ze,a,{})}}function nt(t){let n;return{c(){n=m("div"),g(n,"id","createNoteForm")},m(e,t){u(e,n,t)},p:e,i:e,o:e,d(e){e&&d(n)}}}function lt(e,t,n){let l,o,a;r(e,Y,(e=>n(0,l=e))),r(e,ee,(e=>n(1,o=e))),r(e,V,(e=>n(2,a=e)));let i=[];function s(){const e={fields:{author:{label:"Создать от имени",type:"select",options:i,required:!0},case:{label:"Арбитраж",type:"multiple",value:[],settings:{arbitrage:{label:"Арбитраж",row:1},descr:{label:"Описание",type:"textarea",row:1},amount:{label:"Размер",row:1}}},nickname:{label:"Дисциплины",type:"multiple",value:[],settings:{discipline:{label:"Дисциплина",row:1},room:{label:"Room",row:1},value:{label:"Nick",row:1}}},horizont:{type:"html",value:'<div class="filler"/>'},nicknameOld:{label:"Архивные значения",type:"textarea",visible:!1},FIO:{label:"ФИО",type:"multiple",value:[],settings:{firstname:{label:"Имя",row:1},lastname:{label:"Фамилия",row:1},middlename:{label:"Отчество",row:1}}},horizont2:{type:"html",value:'<hr class="q-ma-none q-pa-none"/>'},htmlHint:{type:"html",value:"Добавляйте значения при помощи клавиши 'enter'"},gipsyteam:{label:"Gipsy team",type:"creatable",outlined:!0},skype:{label:"Аккаунты Skype",type:"creatable",outlined:!0},skrill:{label:"Аккаунты skrill",type:"creatable",outlined:!0},neteller:{label:"Аккаунты neteller",type:"creatable",outlined:!0},phone:{label:"Телефоны",type:"creatable",outlined:!0},pokerstrategy:{label:"Poker Strategy",type:"creatable",outlined:!0},google:{label:"Google аккаунты",type:"creatable",outlined:!0},mail:{label:"Адреса e-mail",type:"creatable",outlined:!0},vk:{label:"Аккаунты vkontakte",type:"creatable",outlined:!0},facebook:{label:"Аккаунты facebook",type:"creatable",outlined:!0},blog:{label:"Блоги",type:"creatable",outlined:!0},instagram:{label:"Аккаунты instagram",type:"creatable",outlined:!0},forum:{label:"Форумы",type:"creatable",outlined:!0},ecopayz:{label:"Аккаунты ecopayz",type:"creatable",outlined:!0},location:{label:"Адреса",type:"multiple",value:[],settings:{country:{label:"Страна",row:1},town:{label:"Город",row:1},address:{label:"Адрес",row:1}}},webmoney:{label:"Аккаунты Webmoney",type:"multiple",value:[],settings:{WMID:{row:1,label:"WMID",required:!0},wallets:{label:"Кошельки",type:"creatable",row:1}}},comments:{label:"Комментарии",type:"textarea"},msg:{type:"html",value:""}},methods:{async onSubmit(e,t,n){e.fields.msg.value="";const l={};for(const[e,t]of Object.entries({...n}))""!==t&&(l[e]=t);const o=await async function(e){const t={method:"POST",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"},body:JSON.stringify({...e})};try{return(await fetch(oe+"table/create",t)).json()}catch(e){return e}}(l);e.fields.msg.value=o.msg}},title:"Создать запись о репутации игрока"};window.callForm2("#createNoteForm",{},e)}return k((async()=>{if("root"===l.role)return Object.entries(o).forEach((([e,t])=>i.push({id:e,name:t}))),s();for(const[e,t]of Object.entries(a))"owner"!==t&&"manager"!==t&&"user"!==t||i.push({id:e,name:o[e]});s()})),[]}class ot extends W{constructor(e){super(),R(this,e,lt,nt,a,{})}}function at(e){let t;return{c(){t=f(e[0])},m(e,n){u(e,t,n)},p(e,n){1&n&&y(t,e[0])},d(e){e&&d(t)}}}function rt(t){let n,l,o=t[0]&&at(t);return{c(){o&&o.c(),n=p(),l=m("div"),g(l,"id","createNoteForm")},m(e,t){o&&o.m(e,t),u(e,n,t),u(e,l,t)},p(e,[t]){e[0]?o?o.p(e,t):(o=at(e),o.c(),o.m(n.parentNode,n)):o&&(o.d(1),o=null)},i:e,o:e,d(e){o&&o.d(e),e&&d(n),e&&d(l)}}}function it(e,t,n){let l,o;r(e,Y,(e=>n(1,l=e))),r(e,ee,(e=>n(2,o=e)));let a=[],i="";const s=new URLSearchParams(window.location.search).get("id");function c(e){console.log("%c⧭","color: #7f7700",e);const t={fields:{author:{label:"Автор",type:"select",options:a,required:!0,disabled:!0},case:{label:"Арбитраж",type:"multiple",value:[],settings:{arbitrage:{label:"Арбитраж",row:1},descr:{label:"Описание",type:"textarea",row:1},amount:{label:"Размер",row:1}}},nickname:{label:"Дисциплины",type:"multiple",value:[],settings:{discipline:{label:"Дисциплина",row:1},room:{label:"Room",row:1},value:{label:"Nick",row:1}}},horizont:{type:"html",value:'<div class="filler"/>'},nicknameOld:{label:"Архивные значения",type:"textarea",visible:!1},FIO:{label:"ФИО",type:"multiple",value:[],settings:{firstname:{label:"Имя",row:1},lastname:{label:"Фамилия",row:1},middlename:{label:"Отчество",row:1}}},horizont2:{type:"html",value:'<hr class="q-ma-none q-pa-none"/>'},htmlHint:{type:"html",value:"Добавляйте значения при помощи клавиши 'enter'"},gipsyteam:{label:"Gipsy team",type:"creatable",outlined:!0},skype:{label:"Аккаунты Skype",type:"creatable",outlined:!0},skrill:{label:"Аккаунты skrill",type:"creatable",outlined:!0},neteller:{label:"Аккаунты neteller",type:"creatable",outlined:!0},phone:{label:"Телефоны",type:"creatable",outlined:!0},pokerstrategy:{label:"Poker Strategy",type:"creatable",outlined:!0},google:{label:"Google аккаунты",type:"creatable",outlined:!0},mail:{label:"Адреса e-mail",type:"creatable",outlined:!0},vk:{label:"Аккаунты vkontakte",type:"creatable",outlined:!0},facebook:{label:"Аккаунты facebook",type:"creatable",outlined:!0},blog:{label:"Блоги",type:"creatable",outlined:!0},instagram:{label:"Аккаунты instagram",type:"creatable",outlined:!0},forum:{label:"Форумы",type:"creatable",outlined:!0},ecopayz:{label:"Аккаунты ecopayz",type:"creatable",outlined:!0},location:{label:"Адреса",type:"multiple",value:[],settings:{country:{label:"Страна",row:1},town:{label:"Город",row:1},address:{label:"Адрес",row:1}}},webmoney:{label:"Аккаунты Webmoney",type:"multiple",value:[],settings:{WMID:{row:1,label:"WMID",required:!0},wallets:{label:"Кошельки",type:"creatable",row:1}}},comments:{label:"Комментарии",type:"textarea"},old:{type:"checkbox",label:"Архивная запись",hint:"снимите флажок, если запись была отредактирована в новый формат"},delButton:{value:"Удалить запись",type:"button",visible:"root"===l.role,color:"red",async onClick(e){const t=await(async e=>{const t={method:"DELETE",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"}};try{return(await fetch(oe+"table/note?id="+e,t)).json()}catch(e){return e}})(s);e.fields.msg.value=t.msg||t}},msg:{type:"html",value:""}},methods:{async onSubmit(e,t,n){e.fields.msg.value="";const l={};for(const[e,t]of Object.entries({...n}))""!==t&&(l[e]=t);const o=await async function(e,t){const n={method:"PUT",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"},body:JSON.stringify({data:e,id:t})};try{return(await fetch(oe+"table/update",n)).json()}catch(e){return e}}(l,s);e.fields.msg.value=o.msg}},title:"Редактировать запись о репутации игрока",buttons:{submit:{label:"Обновить",color:"primary"}}};window.callForm2("#createNoteForm",e,t)}return k((async()=>{const e=await(async e=>{const t={method:"GET",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"}};try{return(await fetch(oe+"table/note?id="+e,t)).json()}catch(e){return e}})(s);if("OK"!==e.status)return n(0,i=e.msg||e);Object.entries(o).forEach((([e,t])=>a.push({id:e,name:t}))),c(e.data)})),[i]}class st extends W{constructor(e){super(),R(this,e,it,rt,a,{})}}function ct(t){let n;return{c(){n=f("404")},m(e,t){u(e,n,t)},i:e,o:e,d(e){e&&d(n)}}}function ut(e){let t,n;return t=new Ae({}),{c(){M(t.$$.fragment)},m(e,l){G(t,e,l),n=!0},i(e){n||(z(t.$$.fragment,e),n=!0)},o(e){K(t.$$.fragment,e),n=!1},d(e){D(t,e)}}}function dt(e){let t,n;return t=new Be({}),{c(){M(t.$$.fragment)},m(e,l){G(t,e,l),n=!0},i(e){n||(z(t.$$.fragment,e),n=!0)},o(e){K(t.$$.fragment,e),n=!1},d(e){D(t,e)}}}function mt(e){let t,n;return t=new Ie({}),{c(){M(t.$$.fragment)},m(e,l){G(t,e,l),n=!0},i(e){n||(z(t.$$.fragment,e),n=!0)},o(e){K(t.$$.fragment,e),n=!1},d(e){D(t,e)}}}function ft(e){let t,n;return t=new st({}),{c(){M(t.$$.fragment)},m(e,l){G(t,e,l),n=!0},i(e){n||(z(t.$$.fragment,e),n=!0)},o(e){K(t.$$.fragment,e),n=!1},d(e){D(t,e)}}}function pt(e){let t,n;return t=new tt({}),{c(){M(t.$$.fragment)},m(e,l){G(t,e,l),n=!0},i(e){n||(z(t.$$.fragment,e),n=!0)},o(e){K(t.$$.fragment,e),n=!1},d(e){D(t,e)}}}function bt(e){let t,n;return t=new De({}),{c(){M(t.$$.fragment)},m(e,l){G(t,e,l),n=!0},i(e){n||(z(t.$$.fragment,e),n=!0)},o(e){K(t.$$.fragment,e),n=!1},d(e){D(t,e)}}}function gt(e){let t,n;return t=new ot({}),{c(){M(t.$$.fragment)},m(e,l){G(t,e,l),n=!0},i(e){n||(z(t.$$.fragment,e),n=!0)},o(e){K(t.$$.fragment,e),n=!1},d(e){D(t,e)}}}function yt(e){let t,n;return t=new Ke({}),{c(){M(t.$$.fragment)},m(e,l){G(t,e,l),n=!0},i(e){n||(z(t.$$.fragment,e),n=!0)},o(e){K(t.$$.fragment,e),n=!1},d(e){D(t,e)}}}function wt(e){let t,n;return t=new ge({}),{c(){M(t.$$.fragment)},m(e,l){G(t,e,l),n=!0},i(e){n||(z(t.$$.fragment,e),n=!0)},o(e){K(t.$$.fragment,e),n=!1},d(e){D(t,e)}}}function ht(e){let t,n;return t=new he({}),{c(){M(t.$$.fragment)},m(e,l){G(t,e,l),n=!0},i(e){n||(z(t.$$.fragment,e),n=!0)},o(e){K(t.$$.fragment,e),n=!1},d(e){D(t,e)}}}function vt(t){let n;return{c(){n=f("Loading...")},m(e,t){u(e,n,t)},i:e,o:e,d(e){e&&d(n)}}}function $t(e){let t,n,l,o,a,r,i,s;n=new de({});const f=[vt,ht,wt,yt,gt,bt,pt,ft,mt,dt,ut,ct],b=[];function y(e,t){return e[0]?e[1].role?"/createFund"===e[2]?2:"/createUser"===e[2]?3:"/createNote"===e[2]?4:"/editUser"===e[2]?5:"/editFund"===e[2]?6:"/editNote"===e[2]?7:"/users"===e[2]?8:"/funds"===e[2]?9:"/"===e[2]?10:11:1:0}return r=y(e),i=b[r]=f[r](e),{c(){t=m("main"),M(n.$$.fragment),l=p(),o=m("div"),a=p(),i.c(),g(o,"class","navFiller svelte-y6p6y1")},m(e,i){u(e,t,i),G(n,t,null),c(t,l),c(t,o),c(t,a),b[r].m(t,null),s=!0},p(e,[n]){let l=r;r=y(e),r!==l&&(I(),K(b[l],1,1,(()=>{b[l]=null})),q(),i=b[r],i||(i=b[r]=f[r](e),i.c()),z(i,1),i.m(t,null))},i(e){s||(z(n.$$.fragment,e),z(i),s=!0)},o(e){K(n.$$.fragment,e),K(i),s=!1},d(e){e&&d(t),D(n),b[r].d()}}}function kt(e,t,n){let l,o;r(e,Y,(e=>n(1,l=e))),r(e,H,(e=>n(2,o=e)));let a=!1;return async function(){const e=await(async()=>{const e={method:"GET",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"}};try{return(await fetch(oe+"auth/refresh",e)).json()}catch(e){return e}})();if(n(0,a=!0),e.status="OK"){e.data.userProps?.funds&&V.set(e.data.userProps.funds);const t={};return e.data.fundNames.length&&e.data.fundNames.forEach((({id:e,name:n})=>t[e]=n)),ee.set(t),s(Y,l=e.data.user,l),void(e.data.userProps?.children&&s(Y,l.children=e.data.userProps.children,l))}Q("/login")}(),H.set(window.location.pathname),window.onpopstate=function(e){H.set("/"+e.state)},[a,l,o]}return new class extends W{constructor(e){super(),R(this,e,kt,$t,a,{})}}({target:document.getElementById("sveltePoint")})}();
